# EifMate

**Claude-to-EiffelStudio Bridge: Enabling AI-Assisted Eiffel Development**

[![Status](https://img.shields.io/badge/status-Phase%200%20Active-green)](https://github.com/ljr1981/eifmate)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![EiffelStudio](https://img.shields.io/badge/EiffelStudio-25.02-green)](https://www.eiffel.com/eiffelstudio/)

EifMate is a command-line bridge that enables Claude AI to compile, query, and test Eiffel projects using EiffelStudio. It features an AI-TODO workflow system that seamlessly integrates with Obsidian for autonomous code generation and iteration.

---

## ğŸ¯ Vision & Purpose

### The Problem
AI assistants like Claude can generate Eiffel code, but they operate in a feedback vacuumâ€”no way to know if the code compiles, what errors occurred, or how to iterate toward working solutions.

### The Solution
EifMate bridges this gap by providing:
- âœ… **AI-TODO Workflow** - Scan code for AI-TODO markers, package requests, process responses
- âœ… **Obsidian Integration** - Bidirectional sync with Obsidian vault for seamless Claude collaboration  
- âœ… **Compile Eiffel projects** via `ec.exe` with structured error reporting
- âœ… **Parse ECMA-367 error codes** with helpful explanations
- âœ… **JSON request/response protocol** for seamless AI integration
- âœ… **Comprehensive testing** with 100% test coverage and file I/O validation
- ğŸš§ **AutoTest integration** for comprehensive testing feedback
- ğŸš§ **Retry/rollback mechanisms** for safe iterative development

### Real-World Impact
Built from Larry Rix's proven experience: **44-66x productivity gains** using AI-assisted development with SIMPLE_JSON library (11,404 lines in 4 days). EifMate aims to replicate and scale these results across all Eiffel projects.

---

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          AI-TODO Workflow (New)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  EM_AI_TODO_SCANNER    Scan files for AI-TODO      â”‚
â”‚  EM_REQUEST_PACKAGER   Create Obsidian requests    â”‚
â”‚  EM_OBSIDIAN_BRIDGE    Vault integration           â”‚
â”‚  EM_REQUEST_MANIFEST   Markdown documentation      â”‚
â”‚  EM_RESPONSE_PROCESSOR Process Claude responses    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“ Obsidian Vault Sync
                â†“
       Claude AI via Obsidian
                â†“
                â†“ JSON Request
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   EM_CLI_APP (eifmate_cli.exe)                     â”‚  
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Core Processing Pipeline                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  EM_REQUEST      Parse JSON requests                â”‚
â”‚  EM_CLI          Orchestrate operations             â”‚
â”‚  EM_COMPILER     Execute ec.exe commands            â”‚
â”‚  EM_PROJECT      ECF configuration                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Error Intelligence                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  EM_ERROR_PARSER       Parse compiler messages      â”‚
â”‚  EM_VALIDITY_CATALOG   ECMA-367 lookup              â”‚
â”‚  EM_ERROR              Structured errors            â”‚
â”‚  EM_ERROR_LOCATION     File/line context            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EM_RESPONSE     Build JSON output                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ Current Status

**Phase:** Phase 0 - Proof of Concept (POC) ğŸŸ¢ **ACTIVE**  
**Development Model:** Dogfooding from Day 1  
**Compilation:** Clean compile âœ…  
**Tests:** All passing (13 tests) âœ…  
**AI-TODO Workflow:** Fully implemented âœ…

### âœ… Completed (Phase 0)

#### AI-TODO Workflow System (NEW)
- [x] `EM_AI_TODO_ITEM` - TODO item representation with scope tracking
- [x] `EM_AI_TODO_SCANNER` - Recursive file scanning with findstr integration
- [x] `EM_OBSIDIAN_BRIDGE` - Vault folder management and file operations
- [x] `EM_REQUEST_MANIFEST` - Markdown manifest generation with timestamps
- [x] `EM_REQUEST_PACKAGER` - Request folder creation and file packaging
- [x] `EM_RESPONSE_PROCESSOR` - Response validation and integration
- [x] `EM_CONSTANTS_AI_TODO_ADDITIONS` - AI-TODO specific constants
- [x] Config file integration (`config.json`, `config_testing.json`)
- [x] Comprehensive testing with file I/O validation
- [x] Serial test execution for folder operations

#### Core Infrastructure
- [x] Project structure with proper ECF configuration
- [x] Multiple targets: library, CLI, tests, future GUI/daemon/server
- [x] Thread concurrency support for PROCESS library
- [x] SIMPLE_JSON integration for request/response handling
- [x] Comprehensive .gitignore for Eiffel projects

#### Core Classes
- [x] `EM_CLI_APP` - CLI entry point with argument handling
- [x] `EM_CLI` - Request orchestration and processing
- [x] `EM_REQUEST` - JSON request parsing
- [x] `EM_RESPONSE` - JSON response building with robust contracts
- [x] `EM_COMPILER` - EiffelStudio compiler wrapper with stateless tuple support
- [x] `EM_PROJECT` - ECF project representation
- [x] `EM_CONSTANTS` - Project-wide named constants

#### Error Intelligence System
- [x] `EM_ERROR` - Structured error representation
- [x] `EM_ERROR_LOCATION` - File/line/column tracking
- [x] `EM_ERROR_PARSER` - State machine parsing for multi-line compiler output
- [x] `EM_VALIDITY_CODE` - ECMA-367 error code model
- [x] `EM_VALIDITY_CATEGORY` - Error categorization
- [x] `EM_VALIDITY_CATALOG` - Error code catalog with explanations

#### Testing Infrastructure
- [x] `TEST_SET_BASE` - Base test class with shared assertions
- [x] `TEST_SET_BASE_WITH_CONSTANTS` - Config-aware test base
- [x] `TESTING_CONSTANTS` - Dynamic config loading from JSON
- [x] `TEST_EM_COMPILER` - Coverage for melt, quick_melt, flat view
- [x] `TEST_EM_OBSIDIAN_BRIDGE` - File I/O and Obsidian integration tests
- [x] `TEST_EM_REQUEST_PACKAGER` - Request packaging tests
- [x] `TEST_EM_AI_TODO_SCANNER` - Scanner tests
- [x] AutoTest framework integration with serial execution
- [x] Automatic test cleanup of temporary files/folders

#### Documentation
- [x] JSON request/response examples
- [x] Usage patterns and examples
- [x] Design pattern documentation
- [x] Updated CRITICAL_PRINCIPLES.md with latest lessons

### ğŸš§ In Progress

- [ ] End-to-end AI-TODO workflow validation
- [ ] ECMA-367 validity codes JSON catalog population
- [ ] MCP protocol server integration

### ğŸ“‹ Planned (Phase 1+)

- [ ] AutoTest integration for test execution
- [ ] Multiple compilation modes (compile/freeze/finalize)
- [ ] Query operations (flat, flatshort, descendants, etc.)
- [ ] Snapshot/restore for safe iteration
- [ ] Retry logic with automatic rollback
- [ ] Timeout handling
- [ ] Watch mode for continuous compilation
- [ ] Optional GUI monitor (Phase 6-7)

---

## ğŸš€ Quick Start

### Prerequisites

- **EiffelStudio 25.02** or later (required)
- **Eiffel PROCESS library** (included with EiffelStudio)
- **SIMPLE_JSON library** ([ljr1981/simple_json](https://github.com/ljr1981/simple_json))
- **Obsidian** (for AI-TODO workflow)
- **Windows** (for `ec.exe` - Unix support planned)

### Configuration

1. **Edit config.json:**
```json
{
  "ec_path": "C:\\Program Files\\Eiffel Software\\EiffelStudio 25.02 Standard\\studio\\spec\\win64\\bin\\ec.exe",
  "default_timeout_seconds": 300,
  "obsidian_path": "C:\\Users\\YourName\\Documents\\Obsidian Vault\\Eiffel\\eifmate"
}
```

2. **Edit testing/config_testing.json:**
```json
{
  "ec_path": "C:\\Program Files\\Eiffel Software\\EiffelStudio 25.02 Standard\\studio\\spec\\win64\\bin",
  "test_project_root": "D:\\prod\\eifmate",
  "test_external_lib_root": "D:\\prod\\simple_json",
  "test_external_target": "simple_json_tests",
  "obsidian_path": "C:\\Users\\YourName\\Documents\\Obsidian Vault\\Eiffel\\eifmate"
}
```

### Building

1. **Clone the repository:**
```bash
git clone https://github.com/ljr1981/eifmate.git
cd eifmate
```

2. **Open in EiffelStudio:**
```bash
estudio eifmate.ecf
```

3. **Select target and compile:**
   - **For development:** Select target `eifmate_tests`
   - **For CLI executable:** Select target `eifmate_cli`
   - **Compile:** Press F7

4. **Run tests:**
   - Navigate to: **Testing > AutoTest**
   - Click: **Execute All Tests**
   - All 13 tests should pass âœ…

---

## ğŸ”§ Usage

### AI-TODO Workflow

#### 1. Add AI-TODO Markers to Your Code

```eiffel
feature -- Implementation

    complex_algorithm
            -- AI-TODO: Implement optimized sorting algorithm
            -- AI-TODO: Add performance benchmarking
        do
            -- Implementation here
        end
```

#### 2. Scan and Package Request

```bash
eifmate_cli.exe ai-todo scan D:\prod\myproject
```

Creates folder structure in Obsidian:
```
Obsidian Vault/
  Eiffel/
    eifmate/
      out-to-AI/
        req_20241120_143022/
          REQUEST.md          # Manifest for Claude
          my_class.e          # Files with AI-TODOs
          another_class.e
```

#### 3. Claude Processes in Obsidian

Claude (via Obsidian MCP integration):
1. Reads REQUEST.md manifest
2. Reviews files with AI-TODOs
3. Implements requested features
4. Writes responses to `in-from-AI/req_20241120_143022/`

#### 4. Process Response

```bash
eifmate_cli.exe ai-todo process req_20241120_143022
```

Validates and integrates Claude's changes back into your project.

### JSON Request/Response Protocol

#### Compile Request
```json
{
  "type": "compile",
  "ecf_path": "D:/projects/myapp/myapp.ecf",
  "target": "myapp_cli"
}
```

#### Response with Enhanced Errors
```json
{
  "success": false,
  "timestamp": "2024-11-20 14:30:22",
  "errors": [
    {
      "code": "VUTA(2)",
      "message": "Target type does not conform",
      "file": "my_class.e",
      "line": 42,
      "explanation": "The type of the target expression does not conform to the type required by the called feature."
    }
  ]
}
```

---

## ğŸ“‚ Project Structure

```
eifmate/
â”œâ”€â”€ eifmate.ecf                    # Project configuration
â”œâ”€â”€ README.md                      # This file
â”œâ”€â”€ config.json                    # Runtime configuration
â”œâ”€â”€ .gitignore                     # Git exclusions
â”‚
â”œâ”€â”€ examples/                      # Example JSON files
â”‚   â”œâ”€â”€ example_request_compile.json
â”‚   â””â”€â”€ example_response.json
â”‚
â”œâ”€â”€ src/
â”‚   â””â”€â”€ cli/                       # All implementation
â”‚       â”œâ”€â”€ em_cli_app.e          # CLI entry point
â”‚       â”‚
â”‚       â”œâ”€â”€ core/                  # Core processing
â”‚       â”‚   â”œâ”€â”€ em_cli.e          # Request orchestration
â”‚       â”‚   â”œâ”€â”€ em_compiler.e     # Compiler wrapper
â”‚       â”‚   â”œâ”€â”€ em_constants.e    # Named constants
â”‚       â”‚   â”œâ”€â”€ em_project.e      # ECF representation
â”‚       â”‚   â”œâ”€â”€ em_request.e      # JSON request parser
â”‚       â”‚   â””â”€â”€ em_response.e     # JSON response builder
â”‚       â”‚
â”‚       â”œâ”€â”€ ai_todo/               # AI-TODO workflow (NEW)
â”‚       â”‚   â”œâ”€â”€ em_ai_todo_item.e              # TODO item model
â”‚       â”‚   â”œâ”€â”€ em_ai_todo_scanner.e           # File scanner
â”‚       â”‚   â”œâ”€â”€ em_obsidian_bridge.e           # Vault integration
â”‚       â”‚   â”œâ”€â”€ em_request_manifest.e          # Manifest generator
â”‚       â”‚   â”œâ”€â”€ em_request_packager.e          # Request packager
â”‚       â”‚   â”œâ”€â”€ em_response_processor.e        # Response processor
â”‚       â”‚   â””â”€â”€ em_constants_ai_todo_additions.e  # Constants
â”‚       â”‚
â”‚       â”œâ”€â”€ error/                 # Error intelligence
â”‚       â”‚   â”œâ”€â”€ em_error.e                # Error model
â”‚       â”‚   â”œâ”€â”€ em_error_location.e       # Location tracking
â”‚       â”‚   â”œâ”€â”€ em_error_parser.e         # Output parsing
â”‚       â”‚   â”œâ”€â”€ em_validity_code.e        # ECMA-367 codes
â”‚       â”‚   â”œâ”€â”€ em_validity_category.e    # Error categories
â”‚       â”‚   â””â”€â”€ em_validity_catalog.e     # Code catalog
â”‚       â”‚
â”‚       â””â”€â”€ validity/              # ECMA-367 catalog
â”‚           â””â”€â”€ em_validity_json.e        # JSON catalog loader
â”‚
â””â”€â”€ testing/
    â”œâ”€â”€ config_testing.json        # Test configuration
    â”œâ”€â”€ test_set_base.e            # Base test class
    â”œâ”€â”€ test_set_base_with_constants.e  # Config-aware base
    â”œâ”€â”€ testing_constants.e        # Config loading
    â””â”€â”€ cli/
        â”œâ”€â”€ test_em_compiler.e     # Compiler tests
        â””â”€â”€ ai_todo/               # AI-TODO tests (NEW)
            â”œâ”€â”€ test_em_ai_todo_scanner.e       # Scanner tests
            â”œâ”€â”€ test_em_obsidian_bridge.e       # Bridge tests
            â””â”€â”€ test_em_request_packager.e      # Packager tests
```

---

## ğŸ“Š Success Metrics

### From SIMPLE_JSON Experience (Validated)
- **Core Library (1000+ LOC):** 1 hour (vs 40-80 traditional)
- **Full Testing (100% coverage):** 1 hour (vs 40-60 traditional)
- **Productivity Gain:** **44-66x faster**

### EifMate Phase 0 Results
- **AI-TODO Workflow:** 8 hours actual (vs 80-120 traditional)
- **Core Infrastructure:** 12 hours actual (vs 100-150 traditional)
- **Testing Suite:** 6 hours actual (vs 60-80 traditional)
- **Total:** 26 hours (vs 240+ traditional)
- **Productivity Gain:** **~10x faster** (lower than 44x due to infrastructure work)

---

## ğŸ”— Related Projects

- **[SIMPLE_JSON](https://github.com/ljr1981/simple_json)** - High-level JSON library for Eiffel
- **[EiffelStudio](https://www.eiffel.com/eiffelstudio/)** - The Eiffel IDE and compiler
- **[Obsidian](https://obsidian.md/)** - Knowledge management for AI-TODO workflow
- **[Model Context Protocol](https://modelcontextprotocol.io/)** - AI-to-tool communication
- **[ECMA-367](https://www.ecma-international.org/publications-and-standards/standards/ecma-367/)** - Eiffel standard

---

## ğŸ“œ License

MIT License - Copyright (c) 2024-2025 Larry Rix

---

## ğŸ“§ Contact & Support

**Author:** Larry Rix  
**GitHub:** [@ljr1981](https://github.com/ljr1981)  
**Project:** [github.com/ljr1981/eifmate](https://github.com/ljr1981/eifmate)

---

## ğŸ™ Acknowledgments

- **Claude Sonnet 4.5** - AI pair programming partner
- **EiffelStudio Team** - For the excellent compiler and tools
- **Obsidian** - For enabling seamless AI-TODO workflow
- **Anthropic** - For Claude and MCP protocol

---

**Status:** ğŸŸ¢ Active Development - Phase 0 Complete  
**Version:** 0.2.0 (AI-TODO Workflow)  
**Last Updated:** November 20, 2025

---

*Built with â¤ï¸ using AI-assisted development. Dogfooding from Day 1.*